<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rose Collection - Premium Clothing</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <a href="index.html" class="logo-link">
                <div class="logo">
                    <i class="fas fa-rose"></i>
                    <h1>Rose Collection</h1>
                </div>
            </a>
            <nav class="nav">
                <a href="index.html" class="active">Home</a>
                <a href="#products">Products</a>
                <a href="#about">About</a>
                <a href="#contact">Contact</a>
                <a href="admin.html" class="admin-link"><i class="fas fa-lock"></i> Admin</a>
            </nav>
            <div class="header-actions">
                <button class="header-btn" id="userBtn">
                    <i class="fas fa-user"></i>
                    <span>Login</span>
                </button>
                <div class="user-dropdown" id="userDropdown" style="display: none;">
                    <a href="my-orders.html"><i class="fas fa-shopping-bag"></i> My Orders</a>
                    <a href="#" onclick="handleLogout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </div>
                <button class="header-btn cart-btn" id="cartBtn">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count" id="cartCount">0</span>
                </button>
            </div>
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <div class="mobile-nav" id="mobileNav">
            <a href="index.html" class="active">Home</a>
            <a href="#products">Products</a>
            <a href="#about">About</a>
            <a href="#contact">Contact</a>
            <a href="admin.html" class="admin-link"><i class="fas fa-lock"></i> Admin</a>
        </div>
    </header>

    <!-- Auth Modal (Login/Signup) -->
    <div id="authModal" class="modal" style="display: none;">
        <div class="modal-content auth-modal">
            <span class="close-modal" onclick="closeAuthModal()">&times;</span>
            <h2 class="auth-modal-title"><i class="fas fa-lock"></i> Login to Rose Collection</h2>

            <!-- Auth Method Tabs -->
            <div class="auth-tabs">
                <button class="auth-tab active" id="tab-google" data-method="google">
                    <i class="fab fa-google"></i> Google
                </button>
                <button class="auth-tab" id="tab-email" data-method="email">
                    <i class="fas fa-envelope"></i> Email
                </button>
                <button class="auth-tab" id="tab-phone" data-method="phone">
                    <i class="fas fa-mobile-alt"></i> Phone OTP
                </button>
            </div>

            <!-- Google Sign-In Content -->
            <div id="googleContent" class="auth-tab-content">
                <p class="auth-subtitle">Quick and secure sign-in</p>

                <button
                    id="googleSignInBtn"
                    class="btn-google full-width"
                    type="button"
                >
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" width="18" height="18">
                    <span>Continue with Google</span>
                </button>

                <div class="google-benefits">
                    <p><i class="fas fa-check-circle"></i> No password needed</p>
                    <p><i class="fas fa-check-circle"></i> Auto-fill your details</p>
                    <p><i class="fas fa-check-circle"></i> One-click login</p>
                </div>
            </div>

            <!-- Phone OTP Content -->
            <div id="phoneOTPContent" class="auth-tab-content" style="display: none;">
                <!-- Step 1: Enter Phone -->
                <div id="phoneInputStep">
                    <p class="auth-subtitle">We'll send you an OTP via SMS</p>

                    <div class="form-group">
                        <label>Phone Number</label>
                        <div class="phone-input-group">
                            <span class="country-code">+91</span>
                            <input
                                type="tel"
                                id="phoneNumberInput"
                                placeholder="9876543210"
                                maxlength="10"
                                pattern="[6-9][0-9]{9}"
                                inputmode="numeric"
                                autocomplete="tel"
                            >
                        </div>
                        <small class="form-hint">10-digit mobile number starting with 6-9</small>
                    </div>

                    <div id="recaptcha-container"></div>

                    <button
                        id="phone-send-otp-btn"
                        class="btn-primary full-width"
                        type="button"
                    >
                        <i class="fas fa-paper-plane"></i> Send OTP
                    </button>
                </div>

                <!-- Step 2: Enter OTP (hidden initially) -->
                <div id="phoneOTPStep" style="display: none;">
                    <p class="auth-subtitle">Enter OTP sent to <strong>+91 <span id="sentToNumber"></span></strong></p>

                    <div class="form-group">
                        <label>6-Digit OTP</label>
                        <div class="otp-inputs">
                            <input type="text" maxlength="1" class="otp-input" data-index="0" inputmode="numeric" pattern="[0-9]">
                            <input type="text" maxlength="1" class="otp-input" data-index="1" inputmode="numeric" pattern="[0-9]">
                            <input type="text" maxlength="1" class="otp-input" data-index="2" inputmode="numeric" pattern="[0-9]">
                            <input type="text" maxlength="1" class="otp-input" data-index="3" inputmode="numeric" pattern="[0-9]">
                            <input type="text" maxlength="1" class="otp-input" data-index="4" inputmode="numeric" pattern="[0-9]">
                            <input type="text" maxlength="1" class="otp-input" data-index="5" inputmode="numeric" pattern="[0-9]">
                        </div>
                    </div>

                    <button
                        id="phone-verify-otp-btn"
                        class="btn-primary full-width"
                        type="button"
                    >
                        <i class="fas fa-check-circle"></i> Verify OTP
                    </button>

                    <div class="otp-resend">
                        <p id="otpTimer" class="otp-timer">Resend OTP in <span id="countdown">60</span>s</p>
                        <button
                            id="resendOTPBtn"
                            class="btn-text"
                            style="display: none;"
                            type="button"
                        >
                            <i class="fas fa-redo"></i> Resend OTP
                        </button>
                    </div>

                    <button class="btn-text" id="backToPhoneInput" type="button">
                        <i class="fas fa-arrow-left"></i> Change Number
                    </button>
                </div>

                <!-- Step 3: Profile Completion (shown for new users, hidden initially) -->
                <div id="phoneProfileStep" style="display: none;">
                    <p class="auth-subtitle">Complete your profile to continue</p>

                    <div class="form-group">
                        <label>Full Name *</label>
                        <input type="text" id="profileName" placeholder="e.g., Ram Kumar" required>
                    </div>
                    <div class="form-group">
                        <label>Email (Optional)</label>
                        <input type="email" id="profileEmail" placeholder="e.g., ram@example.com">
                        <small class="form-hint">Helps with order tracking and notifications</small>
                    </div>

                    <button
                        id="saveProfileBtn"
                        class="btn-primary full-width"
                        type="button"
                    >
                        <i class="fas fa-check"></i> Continue
                    </button>
                </div>
            </div>

            <!-- Email/Password Content -->
            <div id="emailContent" class="auth-tab-content" style="display: none;">
                <!-- Login Form -->
                <div id="emailLoginForm">
                    <p class="auth-subtitle">Sign in with your email and password</p>
                    <form id="loginFormElement">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="loginEmail" placeholder="e.g., user@example.com" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="loginPassword" placeholder="Enter your password" required>
                        </div>
                        <button type="submit" class="btn-primary full-width">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                    </form>
                    <p class="auth-switch">
                        Don't have an account?
                        <a href="#" id="showEmailSignup">Sign Up</a>
                    </p>
                </div>

                <!-- Signup Form -->
                <div id="emailSignupForm" style="display: none;">
                    <p class="auth-subtitle">Create a new account</p>
                    <form id="signupFormElement">
                        <div class="form-group">
                            <label>Full Name *</label>
                            <input type="text" id="signupName" placeholder="e.g., John Doe" required>
                        </div>
                        <div class="form-group">
                            <label>Email *</label>
                            <input type="email" id="signupEmail" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" placeholder="e.g., user@example.com" required>
                            <small class="form-hint">We'll use this for order confirmations</small>
                        </div>
                        <div class="form-group">
                            <label>Phone Number *</label>
                            <input type="tel" id="signupPhone" pattern="[6-9][0-9]{9}" placeholder="e.g., 9876543210" maxlength="10" required>
                            <small class="form-hint">10-digit mobile number for order updates</small>
                        </div>
                        <div class="form-group">
                            <label>Delivery Address (Optional)</label>
                            <textarea id="signupAddress" rows="2" placeholder="Your default delivery address"></textarea>
                            <small class="form-hint">You can add this later</small>
                        </div>
                        <div class="form-group">
                            <label>Password *</label>
                            <input type="password" id="signupPassword" minlength="6" placeholder="At least 6 characters" required>
                        </div>
                        <div class="form-group">
                            <label>Confirm Password *</label>
                            <input type="password" id="signupConfirmPassword" placeholder="Re-enter password" required>
                        </div>
                        <button type="submit" class="btn-primary full-width">
                            <i class="fas fa-user-plus"></i> Create Account
                        </button>
                    </form>
                    <p class="auth-switch">
                        Already have an account?
                        <a href="#" id="showEmailLogin">Login</a>
                    </p>
                </div>
            </div>

            <!-- Loading Overlay -->
            <div id="authLoader" class="auth-loader" style="display: none;">
                <div class="spinner"></div>
                <p id="authLoaderMessage">Processing...</p>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal" style="display: none;">
        <div class="modal-content cart-modal">
            <div class="cart-header">
                <h2><i class="fas fa-shopping-cart"></i> Shopping Cart</h2>
                <span class="close-modal" id="closeCart">&times;</span>
            </div>
            <div class="cart-body" id="cartItems">
                <!-- Cart items will be loaded here -->
            </div>
            <div class="cart-footer">
                <div class="cart-total-section">
                    <h3>Total:</h3>
                    <h3 id="cartTotal">₹0.00</h3>
                </div>
                <button class="btn-primary full-width" id="checkoutBtn">
                    <i class="fas fa-check"></i> Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="modal" style="display: none;">
        <div class="modal-content checkout-modal">
            <span class="close-modal" id="closeCheckout">&times;</span>
            <h2><i class="fas fa-shipping-fast"></i> Delivery Details</h2>
            <form id="checkoutFormElement">
                <div class="form-group">
                    <label>Full Name *</label>
                    <input type="text" id="checkoutName" required>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="checkoutEmail" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" placeholder="e.g., user@example.com" required>
                    <small class="form-hint">Enter a valid email address</small>
                </div>
                <div class="form-group">
                    <label>Phone Number *</label>
                    <input type="tel" id="checkoutPhone" pattern="[6-9][0-9]{9}" placeholder="e.g., 9876543210" maxlength="10" required>
                    <small class="form-hint">Enter 10-digit mobile number</small>
                </div>
                <div class="form-group">
                    <label>Delivery Address *</label>
                    <div class="address-input-wrapper">
                        <textarea id="checkoutAddress" rows="3" placeholder="Enter your complete address" required></textarea>
                        <button type="button" class="btn-location" id="btnGetLocation" title="Use my current location">
                            <i class="fas fa-location-arrow"></i> Use Current Location
                        </button>
                    </div>
                    <small class="form-hint">Click "Use Current Location" to auto-fill your address</small>
                </div>
                <div class="checkout-summary">
                    <p>Cart Total: <strong id="checkoutTotal">₹0.00</strong></p>
                </div>
                <button type="submit" class="btn-primary full-width">
                    <i class="fas fa-check-circle"></i> Place Order
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h2 class="animate-fade-in">Welcome to Rose Collection</h2>
            <p class="animate-fade-in-delay">Discover Premium Clothing & Fashion in Khandwa</p>
            <div class="hero-buttons">
                <a href="#products" class="btn-primary btn-animated">Shop Now</a>
                <a href="#contact" class="btn-secondary btn-animated">Visit Store</a>
            </div>
        </div>
        <div class="hero-features">
            <div class="hero-feature">
                <i class="fas fa-shipping-fast"></i>
                <span>Fast Delivery</span>
            </div>
            <div class="hero-feature">
                <i class="fas fa-certificate"></i>
                <span>Quality Assured</span>
            </div>
            <div class="hero-feature">
                <i class="fas fa-tag"></i>
                <span>Best Prices</span>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="products-section">
        <div class="container">
            <h2 class="section-title">Our Collection</h2>
            <div class="filter-container">
                <button class="filter-btn active" data-category="all">All</button>
                <button class="filter-btn" data-category="men">Men</button>
                <button class="filter-btn" data-category="jeans">Jeans</button>
                <button class="filter-btn" data-category="shirt">Shirt</button>
                <button class="filter-btn" data-category="tshirt">T-Shirt</button>
                <button class="filter-btn" data-category="lower">Lower</button>
                <button class="filter-btn" data-category="hoodies">Hoodies</button>
                <button class="filter-btn" data-category="sweaters">Sweaters</button>
                <button class="filter-btn" data-category="summer-wear">Summer Wear</button>
                <button class="filter-btn" data-category="winter-wear">Winter Wear</button>
                <button class="filter-btn" data-category="others">Others</button>
            </div>
            <div id="products-grid" class="products-grid">
                <!-- Products will be loaded here dynamically -->
            </div>
            <div id="no-products" class="no-products" style="display: none;">
                <i class="fas fa-box-open"></i>
                <p>No products available at the moment.</p>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about-section">
        <div class="container">
            <h2 class="section-title">About Rose Collection</h2>
            <div class="about-content">
                <div class="about-text">
                    <p>Rose Collection is your premier destination for quality clothing and fashion. We curate the finest pieces to elevate your wardrobe with style and elegance.</p>
                    <p>Our commitment is to provide you with exceptional products at competitive prices, ensuring you look your best every day.</p>
                </div>
                <div class="about-features">
                    <div class="feature">
                        <i class="fas fa-shipping-fast"></i>
                        <h3>Fast Delivery</h3>
                        <p>Quick and reliable shipping</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-certificate"></i>
                        <h3>Quality Assured</h3>
                        <p>Premium quality products</p>
                    </div>
                    <div class="feature">
                        <i class="fas fa-headset"></i>
                        <h3>24/7 Support</h3>
                        <p>Always here to help</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <h2 class="section-title">Visit Our Store</h2>
            <div class="contact-wrapper">
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <div>
                            <h3>Address</h3>
                            <p>Naman Tower, Ghanta Ghar Chowk<br>Near Ghanta Ghar, Ghaspura<br>Khandwa, Madhya Pradesh 450001</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <div>
                            <h3>Phone</h3>
                            <p><a href="tel:+917999095600">079990 95600</a></p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-clock"></i>
                        <div>
                            <h3>Store Hours</h3>
                            <p>Mon - Wed: 10:00 AM - 11:00 PM<br>
                            Thursday: <span style="color: #e74c3c; font-weight: 600;">Closed</span><br>
                            Fri - Sun: 10:00 AM - 11:00 PM</p>
                        </div>
                    </div>
                </div>
                <div class="map-container">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3666.0534873!2d76.3456131!3d21.822668!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bd81beda55d72d3%3A0x560a7cbec7fcff5a!2sRose%20Collection!5e0!3m2!1sen!2sin!4v1709120000000!5m2!1sen!2sin" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Rose Collection</h3>
                    <p>Your trusted destination for premium clothing in Khandwa.</p>
                    <div class="social-links">
                        <a href="#" title="Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#products">Products</a></li>
                        <li><a href="#about">About Us</a></li>
                        <li><a href="#contact">Contact</a></li>
                        <li><a href="admin.html">Admin Panel</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact Us</h3>
                    <p><i class="fas fa-phone"></i> 079990 95600</p>
                    <p><i class="fas fa-map-marker-alt"></i> Ghanta Ghar, Khandwa</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 Rose Collection. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button -->
    <button class="scroll-top" id="scrollTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Floating WhatsApp Button -->
    <a href="https://wa.me/917999095600?text=Hi%20Rose%20Collection!%20I%20have%20a%20query."
       class="whatsapp-float"
       target="_blank"
       title="Chat on WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>
    <script src="firebase-products.js"></script>
    <script src="categories.js"></script>
    <script src="orders.js"></script>
    <script src="toast.js"></script>
    <script src="auth.js"></script>
    <script src="cart.js"></script>
    <script src="script.js"></script>
    <script>
        // Initialize auth and cart when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initAuth();
            initCart();
        });

        // Update checkout total when cart changes
        function updateCheckoutTotal() {
            const checkoutTotal = document.getElementById('checkoutTotal');
            if (checkoutTotal) {
                checkoutTotal.textContent = '₹' + getCartTotal().toFixed(2);
            }
        }

        // Call this before showing checkout modal
        function checkout() {
            if (!currentUser) {
                alert('Please login to place an order!');
                closeCartModal();
                showLoginModal();
                return;
            }

            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }

            updateCheckoutTotal();
            document.getElementById('checkoutModal').style.display = 'flex';
            document.getElementById('checkoutName').value = currentUser.displayName || '';
            document.getElementById('checkoutEmail').value = currentUser.email || '';
        }
    </script>
</body>
</html>